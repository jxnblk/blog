{"path":"blog/defining-component-apis-in-react","slug":"defining-component-apis-in-react","title":"Defining Component APIs in React","date":"2018-07-08T00:00:00.000Z","excerpt":"Over the years, I’ve noticed patterns in how I tend to approach component APIs and building out applications and libraries. The following is a collection of thoughts, opinions, and advice for defining component APIs that are meant to be more flexible, composable, and easier to understand. None of these are hard-and-fast rules, but they’ve helped guide the way I think about organizing and creating components.","html":"<p>Over the years, I’ve noticed patterns in how I tend to approach component APIs and building out applications and libraries.\nThe following is a collection of thoughts, opinions, and advice for defining component APIs that are meant to be more flexible, composable, and easier to understand.\nNone of these are hard-and-fast rules, but they’ve helped guide the way I think about organizing and creating components.</p>\n<h2>Aim for a small API surface area</h2>\n<p>Just as the React library itself aims for a <a href=\"https://www.youtube.com/watch?v=4anAwXYqLG8\">Minimal API Surface Area</a>,\nI recommend adopting a similar mindset when it comes to defining component APIs.\nThe fewer new things you need to learn, the easier it is for others to know how to use the components\nthat you create, making them more reusable.\nIf someone doesn’t understand your component API, the chance that they’ll duplicate your work increases.\nThis idea is at the core of how I approach creating components, and I find it helpful to keep in mind as I work.</p>\n<h2>Make things easy to find</h2>\n<p>Start with a flat directory structure and don’t prematurely organize your code base.\nHumans love to organize things, but we’re also really terrible at it.\nNaming things is hard enough, and by creating a directory structure around your component library,\nyou might end up doing more work that makes it more difficult for others to find the things you’ve done.</p>\n<p>A single directory of components can get quite large before it becomes difficult for people to manage.\nAnd if all the components are in a single folder,\nyou’ll get alphabetical ordering for free in most file-system tools,\nwhich can help provide a more complete picture of the code base for others.</p>\n<h2>Avoid renderThing methods</h2>\n<p>If you’ve defined a custom method in your component that starts with the word <code>render</code>,\nchances are that should be its own component.\nAs <a href=\"https://mobile.twitter.com/chrisbiscardi/status/1004559213320814592\">Chris Biscardi</a> puts it, <strong>“[It] effectively means there’s enough complexity to be worth breaking down”</strong>.\nReact’s smart about when to render or not render a component,\nso by splitting these out into their own components, you can help React do its job better.</p>\n<pre><code class=\"language-jsx\">// Instead of this\nclass Items extends React.Component {\n  renderItems ({ items }) {\n    return items.map(item => (\n      &#x3C;li key={item.id}>\n        {renderItem(item)}\n      &#x3C;/li>\n    ))\n  }\n\n  renderItem (item) {\n    return (\n      &#x3C;div>\n        {item.name}\n      &#x3C;/div>\n    )\n  }\n\n  render () {\n    return (\n      &#x3C;ul>\n        {renderItems(this.props)\n      &#x3C;/ul>\n    )\n  }\n}\n</code></pre>\n<pre><code class=\"language-jsx\">// Do this\nconst ItemList = ({ items }) =>\n  &#x3C;ul>\n    {items.map(item => (\n      &#x3C;li key={item.id}>\n        &#x3C;Item {...item} />\n      &#x3C;/li>\n    )}\n  &#x3C;/ul>\n\nconst Item = ({ name }) =>\n  &#x3C;div>{item.name}&#x3C;/div>\n\nclass Items extends React.Component {\n  render () {\n    const { items } = this.props\n    return &#x3C;ItemList items={items} />\n  }\n}\n</code></pre>\n<h2>Split components at data boundaries</h2>\n<p>Often, components should be defined by the shape of your data.</p>\n<blockquote>\n<p>Since you’re often displaying a JSON data model to a user, you’ll find that if your model was built correctly, your UI (and therefore your component structure) will map nicely.</p>\n</blockquote>\n<blockquote>\n<p>– <a href=\"https://facebook.github.io/react/docs/thinking-in-react.html\">Thinking in React</a></p>\n</blockquote>\n<p>I often see people new to React attempt to replicate what I call \"<a href=\"https://getbootstrap.com\">Bootstrap</a>\" components,\nthat is UI components that have a visual boundary that’s not directly tied to any data structure.\nReact and BEM-like CSS-based components have different concerns.\nInstead of creating a generic Card component that displays an image, heading, and link,\nand that would require a custom props API, build components for the data that you’re displaying.\nMaybe the generic Card component should be a ProductCard component that can accept the <code>product</code> object from your database.</p>\n<pre><code class=\"language-jsx\">// Instead of this\n&#x3C;Card\n  image={product.thumbnail}\n  title={product.name}\n  text={product.description}\n  link={product.permalink}\n/>\n\n// Do this\n&#x3C;ProductCard {...product} />\n</code></pre>\n<p>Chances are, the specific styling that you need for the ProductCard isn’t all that reusable,\nand you’ll likely only have this defined in one place in your code base.\nYou can follow the <a href=\"https://en.wikipedia.org/wiki/Rule_of_three_(computer_programming)\">Rule of Three</a> in situations like this.\nIf you've duplicated the exact Card component structure three times in your code base,\nthen it’s probably worth abstracting it out into its own component.</p>\n<h2>Avoid Apropcalypse</h2>\n<p>As <a href=\"https://twitter.com/gurlcode\">Jenn Creighton</a> calls it, avoid <a href=\"https://speakerdeck.com/jenncreighton/flexible-architecture-for-react-components?slide=10\">Apropcalypse</a>.\nDon’t be afraid to create a new component rather than adding abritrary props and additional logic to a component.\nFor example, a Button component might accept props for different colors, sizes, and shapes,\nbut there’s not always a need to have every combination of those props available.</p>\n<pre><code class=\"language-jsx\">// Instead of this\n&#x3C;Button\n  variant='secondary'\n  size='large'\n  outline\n  label='Buy Now'\n  icon='shoppingBag'\n  onClick={handleClick}\n/>\n\n// Do this\n&#x3C;SecondaryButton\n  size='large'\n  onClick={handleClick}>\n  &#x3C;Icon name='shoppingBag' />\n  Buy Now\n&#x3C;/SecondaryButton>\n</code></pre>\n<p>Your needs may vary, but reducing the number of custom props that any component requires is generally helpful,\nand reducing the amount of logic in the render function can make the code base simpler and better-suited for code splitting.</p>\n<h2>Use composition</h2>\n<p>Don’t reinvent <code>props.children</code>.\nIf you’ve defined props that take arbitrary strings of text that aren’t based on a data structure,\nit’s probably better to use composition.</p>\n<pre><code class=\"language-jsx\">// Instead of this\n&#x3C;Header\n  title='Hello'\n  subhead='This is a header'\n  text='And it has arbitrary props'\n/>\n\n// Do this\n&#x3C;Header>\n  &#x3C;Heading>Hello&#x3C;/Heading>\n  &#x3C;Subhead>This is a header&#x3C;/Subhead>\n  &#x3C;Text>And it uses composition&#x3C;/Text>\n&#x3C;/Header>\n</code></pre>\n<p>If you know React, you’ll already know the API for the composed version, and it shouldn’t require as much documentation as the former.\nYou might wrap the composed version into another component that <strong>is</strong> tied to a piece of data in your application,\nbut you’ll probably only need that component structure defined once in your code base.</p>\n<pre><code class=\"language-jsx\">// This makes sense as a component since it’s based on data\nconst PageHeader = ({\n  title,\n  description\n}) =>\n  &#x3C;Header>\n    &#x3C;Heading>{title}&#x3C;/Heading>\n    &#x3C;Text>{description}&#x3C;/Text>\n  &#x3C;/Header>\n\n// And ideally can be used like this\n&#x3C;PageHeader {...page} />\n</code></pre>\n<h2>Avoid boolean props for enums</h2>\n<p>It might be tempting to use <a href=\"https://mobile.twitter.com/satya164/status/1015206655997472768\">boolean props</a> as a convenient way to switch between variants of a component,\nbut it can sometimes create a confusing API.</p>\n<p>Take the following example:</p>\n<pre><code class=\"language-jsx\">&#x3C;Button primary />\n&#x3C;Button secondary />\n</code></pre>\n<p>What happens in the following case?</p>\n<pre><code class=\"language-jsx\">&#x3C;Button primary secondary />\n</code></pre>\n<p>It’s impossible to know without diving into the code base or documentation.\nInstead, try the following:</p>\n<pre><code class=\"language-jsx\">&#x3C;Button variant='primary' />\n</code></pre>\n<p>It’s a little more typing but arguably much more readable.</p>\n<h2>Keep props APIs parallel</h2>\n<p>Whenever possible, resuse props from other components. For example, if you’re creating a date picker, use the same props that the native <code>&#x3C;input type='date' /></code> expects.\nIt’ll be easier to guess how it works and also easier to remember.</p>\n<pre><code class=\"language-jsx\">// Instead of this\n&#x3C;DatePicker\n  date={date}\n  onSelect={handleDateChange}\n/>\n\n// Do this\n&#x3C;DatePicker\n  value={date}\n  onChange={handleDateChange}\n/>\n</code></pre>\n<p>The <a href=\"https://jxnblk.com/styled-system\">Styled System</a> library encourages using a parallel style props API across multiple components.\nFor example, the <code>color</code> prop works the same for all components included in <a href=\"https://jxnblk.com/rebass\">Rebass</a>,\nwhich ends up having a sort of <strong>learn once, use anywhere</strong> effect.</p>\n<pre><code class=\"language-jsx\">// example from Rebass\n&#x3C;Box color='tomato' />\n&#x3C;Heading color='tomato' />\n</code></pre>\n<h2>Ask your teammates</h2>\n<p>These are just some of my own thoughts on how to define component APIs, and they might not suit your needs.\nThe best advice I can give is to talk to your teammates, create RFCs and PRs,\nand try <a href=\"https://ponyfoo.com/articles/readme-driven-development\">Readme Driven Development</a>.\nWriting React components is easy.\nCreating a library of components that works well for your team is worth the time and effort to get right.</p>\n"}